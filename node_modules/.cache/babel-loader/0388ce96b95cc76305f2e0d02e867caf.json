{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport { toast } from \"react-toastify\";\nimport { getError } from \"utils\";\nconst initialState = {\n  cartItems: localStorage.getItem(\"cartItems\") ? JSON.parse(localStorage.getItem(\"cartItems\")) : [],\n  paymentMethod: localStorage.getItem(\"paymentMethod\") ? localStorage.getItem(\"paymentMethod\") : {\n    paymentMethodName: \"\",\n    creditCard: {}\n  },\n  shippingAddress: localStorage.getItem(\"shippingAddress\") ? JSON.parse(localStorage.getItem(\"shippingAddress\")) : {},\n  ordersSummary: localStorage.getItem(\"ordersSummary\") ? JSON.parse(localStorage.getItem(\"ordersSummary\")) : {},\n  orderItems: []\n};\nexport const orderCart = createAsyncThunk(\"cart/orderCart\", async () => {\n  const cartItems = localStorage.getItem(\"cartItems\");\n  const shippingAddress = localStorage.getItem(\"shippingAddress\");\n  const paymentMethod = localStorage.getItem(\"paymentMethod\");\n  const ordersSummary = localStorage.getItem(\"ordersSummary\");\n  const userLocal = JSON.parse(localStorage.getItem(\"user\"));\n\n  try {\n    const result = await axios.post(\"/api/v1/orders\", {\n      orderItems: cartItems,\n      shippingAddress: shippingAddress,\n      paymentMethod: paymentMethod,\n      ordersSummary: ordersSummary.totalPrice\n    }, {\n      headers: {\n        authorization: `Bearer ${userLocal.token}`\n      }\n    });\n    return result === null || result === void 0 ? void 0 : result.data;\n  } catch (error) {\n    toast.error(getError(error));\n  }\n});\nconst cartSlice = createSlice({\n  name: \"cart\",\n  initialState,\n  reducers: {\n    addToCart(state, action) {\n      const itemIndex = state.cartItems.findIndex(item => item._id === action.payload._id);\n\n      if (itemIndex >= 0) {\n        state.cartItems[itemIndex].quantity += 1;\n      } else {\n        const tempProduct = { ...action.payload,\n          quantity: 1\n        };\n        state.cartItems.push(tempProduct);\n      }\n\n      localStorage.setItem(\"cartItems\", JSON.stringify(state.cartItems));\n    },\n\n    increaseCart(state, action) {\n      const itemIndex = state.cartItems.findIndex(item => item._id === action.payload._id);\n\n      if (state.cartItems[itemIndex].quantity >= 1) {\n        state.cartItems[itemIndex].quantity += 1;\n      }\n\n      localStorage.setItem(\"cartItems\", JSON.stringify(state.cartItems));\n    },\n\n    decreaseCart(state, action) {\n      const itemIndex = state.cartItems.findIndex(item => item._id === action.payload._id);\n\n      if (state.cartItems[itemIndex].quantity > 1) {\n        state.cartItems[itemIndex].quantity -= 1;\n      }\n\n      localStorage.setItem(\"cartItems\", JSON.stringify(state.cartItems));\n    },\n\n    removeFromCart(state, action) {\n      const newCartItems = state.cartItems.filter(cartItem => cartItem._id !== action.payload._id);\n      state.cartItems = newCartItems;\n      localStorage.setItem(\"cartItems\", JSON.stringify(state.cartItems));\n    },\n\n    clearAllCart(state, action) {\n      state.cartItems = [];\n      localStorage.setItem(\"cartItems\", JSON.stringify(state.cartItems));\n    },\n\n    saveShippingAddress(state, action) {\n      state.shippingAddress = action.payload;\n      localStorage.setItem(\"shippingAddress\", JSON.stringify(state.shippingAddress));\n    },\n\n    deleteShippingAddress(state, action) {\n      state.shippingAddress = {};\n      localStorage.setItem(\"shippingAddress\", JSON.stringify(state.shippingAddress));\n    },\n\n    savePaymentMethod(state, action) {\n      state.paymentMethod = action.payload;\n      localStorage.setItem(\"paymentMethod\", JSON.stringify(state.paymentMethod));\n    }\n\n  },\n  extraReducers: builder => {\n    builder.addCase();\n  }\n});\nexport const {\n  addToCart,\n  decreaseCart,\n  increaseCart,\n  removeFromCart,\n  clearAllCart,\n  saveShippingAddress,\n  deleteShippingAddress,\n  savePaymentMethod\n} = cartSlice.actions;\nexport default cartSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","axios","toast","getError","initialState","cartItems","localStorage","getItem","JSON","parse","paymentMethod","paymentMethodName","creditCard","shippingAddress","ordersSummary","orderItems","orderCart","userLocal","result","post","totalPrice","headers","authorization","token","data","error","cartSlice","name","reducers","addToCart","state","action","itemIndex","findIndex","item","_id","payload","quantity","tempProduct","push","setItem","stringify","increaseCart","decreaseCart","removeFromCart","newCartItems","filter","cartItem","clearAllCart","saveShippingAddress","deleteShippingAddress","savePaymentMethod","extraReducers","builder","addCase","actions","reducer"],"sources":["C:/tiedostot/integrify/fs12-fullstack/client/src/features/cartSlice.js"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\r\nimport axios from \"axios\";\r\nimport { toast } from \"react-toastify\";\r\nimport { getError } from \"utils\";\r\n\r\nconst initialState = {\r\n  cartItems: localStorage.getItem(\"cartItems\")\r\n    ? JSON.parse(localStorage.getItem(\"cartItems\"))\r\n    : [],\r\n\r\n  paymentMethod: localStorage.getItem(\"paymentMethod\")\r\n    ? localStorage.getItem(\"paymentMethod\")\r\n    : {\r\n        paymentMethodName: \"\",\r\n        creditCard: {},\r\n      },\r\n\r\n  shippingAddress: localStorage.getItem(\"shippingAddress\")\r\n    ? JSON.parse(localStorage.getItem(\"shippingAddress\"))\r\n    : {},\r\n\r\n  ordersSummary: localStorage.getItem(\"ordersSummary\")\r\n    ? JSON.parse(localStorage.getItem(\"ordersSummary\"))\r\n    : {},\r\n\r\n  orderItems: [],\r\n};\r\n\r\nexport const orderCart = createAsyncThunk(\"cart/orderCart\", async () => {\r\n  const cartItems = localStorage.getItem(\"cartItems\");\r\n  const shippingAddress = localStorage.getItem(\"shippingAddress\");\r\n  const paymentMethod = localStorage.getItem(\"paymentMethod\");\r\n  const ordersSummary = localStorage.getItem(\"ordersSummary\");\r\n  const userLocal = JSON.parse(localStorage.getItem(\"user\"));\r\n\r\n  try {\r\n    const result = await axios.post(\r\n      \"/api/v1/orders\",\r\n\r\n      {\r\n        orderItems: cartItems,\r\n        shippingAddress: shippingAddress,\r\n        paymentMethod: paymentMethod,\r\n        ordersSummary: ordersSummary.totalPrice,\r\n      },\r\n      {\r\n        headers: {\r\n          authorization: `Bearer ${userLocal.token}`,\r\n        },\r\n      }\r\n    );\r\n    return result?.data;\r\n  } catch (error) {\r\n    toast.error(getError(error));\r\n  }\r\n});\r\n\r\nconst cartSlice = createSlice({\r\n  name: \"cart\",\r\n  initialState,\r\n  reducers: {\r\n    addToCart(state, action) {\r\n      const itemIndex = state.cartItems.findIndex(\r\n        (item) => item._id === action.payload._id\r\n      );\r\n\r\n      if (itemIndex >= 0) {\r\n        state.cartItems[itemIndex].quantity += 1;\r\n      } else {\r\n        const tempProduct = { ...action.payload, quantity: 1 };\r\n        state.cartItems.push(tempProduct);\r\n      }\r\n      localStorage.setItem(\"cartItems\", JSON.stringify(state.cartItems));\r\n    },\r\n\r\n    increaseCart(state, action) {\r\n      const itemIndex = state.cartItems.findIndex(\r\n        (item) => item._id === action.payload._id\r\n      );\r\n      if (state.cartItems[itemIndex].quantity >= 1) {\r\n        state.cartItems[itemIndex].quantity += 1;\r\n      }\r\n      localStorage.setItem(\"cartItems\", JSON.stringify(state.cartItems));\r\n    },\r\n    decreaseCart(state, action) {\r\n      const itemIndex = state.cartItems.findIndex(\r\n        (item) => item._id === action.payload._id\r\n      );\r\n      if (state.cartItems[itemIndex].quantity > 1) {\r\n        state.cartItems[itemIndex].quantity -= 1;\r\n      }\r\n      localStorage.setItem(\"cartItems\", JSON.stringify(state.cartItems));\r\n    },\r\n    removeFromCart(state, action) {\r\n      const newCartItems = state.cartItems.filter(\r\n        (cartItem) => cartItem._id !== action.payload._id\r\n      );\r\n      state.cartItems = newCartItems;\r\n      localStorage.setItem(\"cartItems\", JSON.stringify(state.cartItems));\r\n    },\r\n    clearAllCart(state, action) {\r\n      state.cartItems = [];\r\n      localStorage.setItem(\"cartItems\", JSON.stringify(state.cartItems));\r\n    },\r\n    saveShippingAddress(state, action) {\r\n      state.shippingAddress = action.payload;\r\n      localStorage.setItem(\r\n        \"shippingAddress\",\r\n        JSON.stringify(state.shippingAddress)\r\n      );\r\n    },\r\n    deleteShippingAddress(state, action) {\r\n      state.shippingAddress = {};\r\n      localStorage.setItem(\r\n        \"shippingAddress\",\r\n        JSON.stringify(state.shippingAddress)\r\n      );\r\n    },\r\n    savePaymentMethod(state, action) {\r\n      state.paymentMethod = action.payload;\r\n      localStorage.setItem(\r\n        \"paymentMethod\",\r\n        JSON.stringify(state.paymentMethod)\r\n      );\r\n    },\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder.addCase();\r\n  },\r\n});\r\n\r\nexport const {\r\n  addToCart,\r\n  decreaseCart,\r\n  increaseCart,\r\n  removeFromCart,\r\n  clearAllCart,\r\n  saveShippingAddress,\r\n  deleteShippingAddress,\r\n  savePaymentMethod,\r\n} = cartSlice.actions;\r\nexport default cartSlice.reducer;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}