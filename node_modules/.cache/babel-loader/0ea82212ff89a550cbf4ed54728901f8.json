{"ast":null,"code":"import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport { toast } from \"react-toastify\";\nimport { getError } from \"utils\";\nimport { useParams } from 'react-router-dom';\nconst initialState = {\n  products: [],\n  error: null,\n  status: \"\",\n  singleProduct: []\n};\nexport const productsFetch = createAsyncThunk(\"products/productsFetch\", async () => {\n  const result = await axios.get(\"/api/v1/products\");\n  return result === null || result === void 0 ? void 0 : result.data;\n});\nexport const productFetch = createAsyncThunk(\"product/productFetch\", async (id, _ref) => {\n  let {\n    rejectWithValue\n  } = _ref;\n\n  try {\n    const result = await axios.get(\"/api/v1/products/product/\" + id);\n    console.log(result.data);\n    return result === null || result === void 0 ? void 0 : result.data;\n  } catch (error) {\n    return rejectWithValue(error.response.data);\n  }\n});\nexport const adminRemoveProduct = createAsyncThunk(\"product/deleteProduct\", async (_ref2, _ref3) => {\n  let {\n    _id,\n    toast\n  } = _ref2;\n  let {\n    rejectWithValue\n  } = _ref3;\n\n  try {\n    const result = await axios.delete(\"/api/v1/products/\" + _id);\n    toast.success(\"Product Deleted Successfully\");\n    return result === null || result === void 0 ? void 0 : result.data;\n  } catch (err) {\n    return rejectWithValue(err.result.data);\n  }\n});\nexport const adminCreateProduct = createAsyncThunk(\"product/createProduct\", async _ref4 => {\n  let {\n    navigate\n  } = _ref4;\n\n  if (window.confirm(\"Are you sure to create?\")) {\n    try {\n      const userLocal = JSON.parse(localStorage.getItem(\"user\"));\n      const result = await axios.post(\"/api/v1/products\", {}, {\n        headers: {\n          'authorization': `Bearer ${userLocal.token}`\n        }\n      });\n      toast.success('product created successfully');\n      navigate(`/admin/product/${result === null || result === void 0 ? void 0 : result.data.product._id}`);\n      return result === null || result === void 0 ? void 0 : result.data;\n    } catch (error) {\n      toast.error(getError(error));\n    }\n  }\n});\nexport const adminUpdateProduct = createAsyncThunk(\"product/updateProduct\", async _ref5 => {\n  let {\n    id,\n    toast\n  } = _ref5;\n\n  try {\n    const result = await axios.get(\"/api/v1/products/product/\" + id);\n    return result === null || result === void 0 ? void 0 : result.data;\n  } catch (error) {\n    toast.error(getError(error));\n  }\n});\nconst productsSlice = createSlice({\n  name: \"products\",\n  initialState,\n  reducers: {},\n  extraReducers: builder => {\n    builder.addCase(productsFetch.pending, state => {\n      state.status = \"pending\";\n    }).addCase(productsFetch.fulfilled, (state, action) => {\n      state.status = \"success\";\n      state.products = action.payload;\n    }).addCase(productsFetch.rejected, (state, action) => {\n      state.status = \"rejected\";\n      state.error = \"Data not loaded!!!\";\n    }).addCase(adminCreateProduct.pending, state => {\n      state.status = \"pending\";\n    }).addCase(adminCreateProduct.fulfilled, (state, action) => {\n      state.status = \"success\";\n      state.products = action.payload;\n    }).addCase(adminCreateProduct.rejected, (state, action) => {\n      state.status = \"rejected\";\n      state.error = \"Data not loaded!!!\";\n    }).addCase(productFetch.pending, state => {\n      state.status = \"pending\";\n    }).addCase(productFetch.fulfilled, (state, action) => {\n      state.status = \"success\";\n      state.singleProduct = action.payload;\n    }).addCase(productFetch.rejected, (state, action) => {\n      state.status = \"rejected\";\n      state.error = action.payload.message;\n    }).addCase(adminUpdateProduct.pending, state => {\n      state.status = \"pending\";\n    }).addCase(adminUpdateProduct.fulfilled, (state, action) => {\n      state.status = \"success\";\n      state.singleProduct = action.payload;\n    }).addCase(adminUpdateProduct.rejected, (state, action) => {\n      state.status = \"rejected\";\n      state.error = action.payload.message;\n    }).addCase(adminRemoveProduct.pending, state => {\n      state.status = \"pending\";\n    }).addCase(adminRemoveProduct.fulfilled, (state, action) => {\n      state.status = \"success\";\n      const {\n        arg: {\n          id\n        }\n      } = action.meta;\n\n      if (id) {\n        state.userTours = state.userTours.filter(item => item._id !== id);\n        state.tours = state.tours.filter(item => item._id !== id);\n      }\n    }).addCase(adminRemoveProduct.rejected, (state, action) => {\n      state.status = \"rejected\";\n      state.error = action.payload.message;\n    });\n  }\n});\nexport default productsSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","toast","getError","useParams","initialState","products","error","status","singleProduct","productsFetch","result","get","data","productFetch","id","rejectWithValue","console","log","response","adminRemoveProduct","_id","delete","success","err","adminCreateProduct","navigate","window","confirm","userLocal","JSON","parse","localStorage","getItem","post","headers","token","product","adminUpdateProduct","productsSlice","name","reducers","extraReducers","builder","addCase","pending","state","fulfilled","action","payload","rejected","message","arg","meta","userTours","filter","item","tours","reducer"],"sources":["C:/tiedostot/integrify/fs12-fullstack/client/src/features/productsSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\r\nimport axios from \"axios\";\r\nimport { toast } from \"react-toastify\";\r\nimport { getError } from \"utils\";\r\nimport { useParams } from 'react-router-dom';\r\n\r\n\r\nconst initialState = {\r\n  products: [],\r\n  error: null,\r\n  status: \"\",\r\n  singleProduct: [],\r\n};\r\n\r\nexport const productsFetch = createAsyncThunk(\r\n  \"products/productsFetch\",\r\n  async () => {\r\n    const result = await axios.get(\"/api/v1/products\");\r\n    return result?.data;\r\n  }\r\n);\r\nexport const productFetch = createAsyncThunk(\r\n  \"product/productFetch\",\r\n  async (id, { rejectWithValue }) => {\r\n    try {\r\n      const result = await axios.get(\"/api/v1/products/product/\" + id);\r\n      console.log(result.data);\r\n      return result?.data;\r\n    } catch (error) {\r\n      return rejectWithValue(error.response.data);\r\n    }\r\n  }\r\n);\r\nexport const adminRemoveProduct = createAsyncThunk(\r\n  \"product/deleteProduct\",\r\n  async ({ _id, toast }, { rejectWithValue }) => {\r\n    try {\r\n      const result = await axios.delete(\"/api/v1/products/\" + _id);\r\n      toast.success(\"Product Deleted Successfully\");\r\n      return result?.data;\r\n    } catch (err) {\r\n      return rejectWithValue(err.result.data);\r\n    }\r\n  }\r\n);\r\n\r\nexport const adminCreateProduct = createAsyncThunk(\r\n  \"product/createProduct\",\r\n  async ({navigate}) => {\r\n\t\r\n    if (window.confirm(\"Are you sure to create?\")) {\r\n\t\ttry {\r\n\t\t\t\r\n\t\t\tconst userLocal = JSON.parse(localStorage.getItem(\"user\"));\r\n\t\t\tconst result = await axios.post(\"/api/v1/products\", {}, {\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t'authorization': `Bearer ${userLocal.token}`,\r\n\t\t\t\t  },\r\n\t\t\t\t  \r\n\t\t\t})\r\n\t\t\ttoast.success('product created successfully');\r\n\t\t\tnavigate(`/admin/product/${result?.data.product._id}`);\r\n\t\t\treturn result?.data;\r\n\t\t\t\r\n\t\t} catch (error) {\r\n\t\t\ttoast.error(getError(error));\r\n\t\t}\r\n    }\r\n  }\r\n);\r\n\r\nexport const adminUpdateProduct = createAsyncThunk(\"product/updateProduct\", async ({ id, toast }) => {\r\n\r\n\ttry {\r\n\t\t\r\n\t\tconst result = await axios.get(\"/api/v1/products/product/\" + id);\r\n\t\treturn result?.data;\r\n\t} catch (error) {\r\n\t\ttoast.error(getError(error));\r\n\t}\r\n\r\n})\r\n\r\n\r\n\r\nconst productsSlice = createSlice({\r\n  name: \"products\",\r\n  initialState,\r\n  reducers: {},\r\n  extraReducers: (builder) => {\r\n    builder\r\n      .addCase(productsFetch.pending, (state) => {\r\n        state.status = \"pending\";\r\n      })\r\n      .addCase(productsFetch.fulfilled, (state, action) => {\r\n        state.status = \"success\";\r\n        state.products = action.payload;\r\n      })\r\n      .addCase(productsFetch.rejected, (state, action) => {\r\n        state.status = \"rejected\";\r\n        state.error = \"Data not loaded!!!\";\r\n      })\r\n      .addCase(adminCreateProduct.pending, (state) => {\r\n        state.status = \"pending\";\r\n      })\r\n      .addCase(adminCreateProduct.fulfilled, (state, action) => {\r\n        state.status = \"success\";\r\n        state.products = action.payload;\r\n      })\r\n      .addCase(adminCreateProduct.rejected, (state, action) => {\r\n        state.status = \"rejected\";\r\n        state.error = \"Data not loaded!!!\";\r\n      })\r\n      .addCase(productFetch.pending, (state) => {\r\n        state.status = \"pending\";\r\n      })\r\n      .addCase(productFetch.fulfilled, (state, action) => {\r\n        state.status = \"success\";\r\n        state.singleProduct = action.payload;\r\n      })\r\n      .addCase(productFetch.rejected, (state, action) => {\r\n        state.status = \"rejected\";\r\n        state.error = action.payload.message;\r\n      })\r\n      .addCase(adminUpdateProduct.pending, (state) => {\r\n        state.status = \"pending\";\r\n      })\r\n      .addCase(adminUpdateProduct.fulfilled, (state, action) => {\r\n        state.status = \"success\";\r\n        state.singleProduct = action.payload;\r\n      })\r\n      .addCase(adminUpdateProduct.rejected, (state, action) => {\r\n        state.status = \"rejected\";\r\n        state.error = action.payload.message;\r\n      })\r\n      .addCase(adminRemoveProduct.pending, (state) => {\r\n        state.status = \"pending\";\r\n      })\r\n      .addCase(adminRemoveProduct.fulfilled, (state, action) => {\r\n        state.status = \"success\";\r\n        const {\r\n          arg: { id },\r\n        } = action.meta;\r\n        if (id) {\r\n          state.userTours = state.userTours.filter((item) => item._id !== id);\r\n          state.tours = state.tours.filter((item) => item._id !== id);\r\n        }\r\n      })\r\n      .addCase(adminRemoveProduct.rejected, (state, action) => {\r\n        state.status = \"rejected\";\r\n        state.error = action.payload.message;\r\n      });\r\n  },\r\n});\r\n\r\nexport default productsSlice.reducer;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}